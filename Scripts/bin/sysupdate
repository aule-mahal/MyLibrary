#! /bin/bash

#THIS SCRIPT IS INCOMPLETE AND BUGGY AS HELL
echo "NOT WORKING YET"
exit 3

#This script peforms automated system update, it also checks if there is a kernel update and if so,
#it reinstalls the broadcom driver

WAR="WARNING! This script will perform an automated system update, are you sure you want to proceed?(y/n) "
LIN="Kernel update avaible. Will reinstall Broadcom driver."
REB="Update complete. Reboot?(y/n) "


read -p "$WAR"  choicewar
case "$choicewar" in
	y|Y ) echo "Continuing...";;
	n|N	) echo "Aborting update!" && exit 1;;
	*	) echo "Invalid argument" && exit 1;;
esac

echo

#update package list
pacman -Syy

#pacman -Qu will list packages to be updated
#this aint right -- Trying new fix (adding $(command) to nest variable)
KER=$(pacman -Qu | grep linux)
if [ -z "$KER" ] #if no kernel packages, update normally
then
	echo "Standard update..."
	yaourt -Syu
else			#else reinstall broadcom driver
	echo "$LIN"
	yaourt -Syu
	yaourt -S broadcom-wl --noconfirm
fi

echo

#reboot(y)
read -p "$REB" choice
case "$choice" in
	y|Y ) reboot;;
	* )	echo "Exiting sysupdate.";;
esac
